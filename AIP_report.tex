\documentclass[12pt,a4j]{jsarticle}

\usepackage{bm}	% ベクトル修飾の太字がキレイに出せる
\usepackage{mathrsfs}	% 飾文字
\usepackage{amsmath,amssymb} % 数学系

\newcommand{\xa}{x_\alpha}
\newcommand{\bxa}{\bar{x}_\alpha}
\newcommand{\dxa}{\Delta x_\alpha}
\newcommand{\ya}{y_\alpha}
\newcommand{\bya}{\bar{y}_\alpha}
\newcommand{\dya}{\Delta y_\alpha}
\newcommand{\xia}{\bm{\xi}_\alpha}
\newcommand{\bxia}{\bar{\bm{\xi}}_\alpha}

\title{画像工学特論 レポート}
\author{163377 宮田木織}

\begin{document}
  \maketitle % タイトルを出力

\section*{課題2}
  式と式番号を以下のように置きなおす。

  \begin{align}
    \xia &= \begin{pmatrix}\xa^2 & 2\xa\ya & \ya^2 & 2f_0\ya & f_0^2\end{pmatrix}^\top
     & \quad\cdots\text{誤差を含む点データ} \\
    \bxia &= \begin{pmatrix}\bxa^2 & 2\bxa\bya & \bya^2 & 2f_0\bya & f_0^2\end{pmatrix}^\top
     & \quad\cdots\text{$\xa$と$\ya$を真値とした$\xia$} \\
    \bm{u} &= \begin{pmatrix}A & B & C & D & E & F\end{pmatrix}^\top
     & \quad\cdots\text{楕円のパラメータ} \\
    \bm{M} &= \sum_{\alpha = 1}^N \xia \xia^\top
     & \quad\cdots\text{レポート問題文中式(2)より} \label{eq:M}
  \end{align}

  \subsection*{2-1}

  全ての$\bxia$について下式が成り立つ。

  \begin{equation}
    (\bm{u}, \bxia) = 0
  \end{equation}

  ここから単純に考えると、$\xia$に関しては、下式の$(\bm{u}, \xia)$の2乗和$J_{LS}$が最小となるような$\bm{u}$がパラメータとして最もらしいと言える。

  \begin{equation}
    J_{LS} = \sum_{\alpha = 1}^N (\bm{u}, \xia)^2 \label{eq:JLS}
  \end{equation}

  最小二乗法は、この考えに基づき、$J_{LS}$を目的関数として最小化することで、$\bm{u}$を推測する手法である。\par
  ここで、式(\ref{eq:JLS})を展開・整理すると下式となる。

  \begin{align}
    \sum_{\alpha = 1}^N (\bm{u}, \xia)^2 &= \sum_{\alpha = 1}^N (\xia, \bm{u})^2 \nonumber \\
     &= \sum_{\alpha = 1}^N \xia^\top \bm{u} \xia^\top \bm{u} \nonumber \\
     &= \sum_{\alpha = 1}^N \bm{u}^\top \xia \xia^\top \bm{u} \nonumber \\
     &= \bm{u}^\top \left(\sum_{\alpha = 1}^N \xia \xia^\top \right) \bm{u} \label{eq:organized}
  \end{align}

  式(\ref{eq:organized})を式(\ref{eq:M})を用いて置きなおすことで、$J_{LS}$は以下のように書くことができる。

  \begin{equation}
    J_{LS} = (\bm{u}, \bm{Mu})
  \end{equation}

  以上のとおり、最小二乗法で楕円のパラメータを推定するときの目的関数$J_{LS}$が示された。

  \subsection*{2-2}
    \subsubsection*{誤差と共分散行列}
      $\xa$と$\ya$は、それぞれを真値と誤差の和として以下のように表せる。

      \begin{equation}
        \xa = \bxa + \dxa, \quad \ya = \bya + \dya
      \end{equation}

      これを用いて$\xia$を表すと、以下のようになる。
      \begin{equation}
        \xia = \bxia + \Delta_1\xia + \Delta_2\xia
      \end{equation}
      \begin{align}
        \Delta_1\xia &= \begin{pmatrix}2\bxa\dxa & 2\dxa\bya + 2\bxa\dya & 2\bya\dya & 2f_0\dxa & 2f_0\dya & 0\end{pmatrix}^\top \\
        \Delta_2\xia &= \begin{pmatrix}\dxa^2 & 2\dxa\dya & \dya^2 & 0 & 0 & 0 \end{pmatrix}^\top
      \end{align}

      ここで、誤差が確率変数であるとみなし、$\xia$の共分散行列を下式のように定義する。ただし、$\Delta_2\xia$は十分に小さいものとして無視している。
      \begin{align}
        V[\xia] &= E[\Delta_1\xia\Delta_1\xia^\top] \\
        \Delta_1\xia\Delta_1\xia^\top &= 4\begin{pmatrix}
          \bm{a} & \bm{b} & \bm{c} & \bm{d} & \bm{e} & \bm{f}
        \end{pmatrix}
      \end{align}

      \begin{equation}
        V[\xia] = E[\Delta_1\xia\Delta_1\xia^\top]
      \end{equation}

      更に、誤差が互いに独立な期待値$0$、標準偏差$\sigma$の正規分布に従うなら、
      \begin{equation}
        E[\dxa] = E[\dya] = E[\dxa\dya] = 0, \quad E[\dxa^2] = E[\dya^2] = \sigma
      \end{equation}
      であるため、共分散行列は以下のように書ける。
    
    \subsubsection*{最尤推定}
      楕円とそれぞれの点との距離の総和として、マハラノビス距離を以下のように定義する。
      \begin{equation}
        J = \sum_{\alpha = 1}^N \left(\xia - \bxia, \bm{V}_0[\xia]^{-1} (\xia - \bxia) \right)
      \end{equation}

\end{document}
